ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2,
alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5,
Lat < 45,
Lng >3),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)  +
xlim(3,8) + ylim(42,45)
ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2,
alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5,
Lat < 45,
Lng >3),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)  +
xlim(2,8) + ylim(42,45)
result.ZW %>% filter(N==41)
ref %>% filter(N==41)
result.TS %>% filter(N==41)
viz.TS %>% filter(N==41)
viz.ZW %>% filter(N==41)
ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2,
alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5,
Lat < 45,
Lng >3),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)  +
xlim(3,8) + ylim(43,45)
k =41
ggplot() +
geom_tile(data = viz.ZW %>% filter(N == k),
aes(r,u, alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5,
Lat < 45,
Lng >3),
aes(Lng, Lat,
col = as.factor(Societe))) +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)
viz.TS
min(viz.TS$Slat)
min(viz.TS$Slat)
min(viz.TS$Slng)
for(k in 1:nrow(ref)){
t <- ggplot() +
geom_tile(data = viz.ZW %>% filter(N == k),
aes(r,u, alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat,
col = as.factor(Societe))) +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)
ggplot() +
geom_tile(data = viz.ZW %>% filter(N == k),
aes(r,u, alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat,
col = as.factor(Societe))) +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)
ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2,
alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)
ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2,
alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)  +
xlim(1,8) + ylim(42,45)
ref
viz.TS %>% select(ID,Nom) %>% distinct
trx
input
input %>% filter(Badge == 9800223) %>% select(Badge,Porteur) %>% distinct
result.TS
result.ZW
r.TS <- result.TS %>% filter(ID != 980022310004)
ggplot(viz.TS) +
geom_segment(aes(x=Elng,xend=Slng,
y=Elat,yend=Slat, alpha = noPsg )
) +
facet_wrap(~Nom)
ggplot() +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat, alpha = noPsg )
) +
geom_tile(data = viz.ZW, aes(l + gridStep/2,d + gridStep/2, alpha = Per)) +
facet_wrap(~Nom)
ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2,
alpha = Per)
) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)  +
xlim(1,8) + ylim(42,45)
ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2, alpha = Per)) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,Slat),
colour = "red",
size = 4
) +
facet_wrap(~Nom)
ggplot() +
geom_tile(data = viz.ZW,
aes(l + gridStep/2, d + gridStep/2, alpha = Per)) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat, col = as.factor(Societe)),
alpha = .5) +
geom_segment(data = viz.TS,
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0),
aes(Slng,Slat),
colour = "red",
size = 4
) +
facet_wrap(~Nom)  +
xlim(1,8) + ylim(42,45)
viz.ZW %>% select(ID,Nom) %>% distinct
viz.ZW %>% select(ID,Nom,N) %>% distinct
viz.ZW %>% select(ID,Nom,N) %>% distinct %>% arrange(N)
viz.ZW %>% select(ID,Nom,N) %>% distinct %>% arrange(N) %>% print(n=50)
t <- ggplot()
t
for(k in 1:nrow(ref)){
t <- ggplot()
t.ZW <- viz.ZW %>% filter(N == k)
t.TS <- viz.TS %>% filter(N == k)
if(nrow(t.ZW) > 0) {
t <- t +
geom_tile(data = t.ZW,
aes(r,u, alpha = Per)) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat,
col = as.factor(Societe)))
}
if(nrow(t.TS) > 0){
t <- t +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2)
}
if(nrow(t.TS %>% filter(Entr == 0)) > 0){
t <- t +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng, Slat),
colour = "red",
size = 4)
}
t <- t + facet_wrap(~Nom)
ggsave(filename = paste(ref$Nom[ref$N == k], '.jpg', sep=""),
plot = t)
}
t <- ggplot() +
geom_tile(data = viz.ZW %>% filter(N == k),
aes(r,u, alpha = Per)
)
t1 <- t+  geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat,
col = as.factor(Societe))) +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2
) +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng,
Slat
),
colour = "red",
size = 4
) +
facet_wrap(~Nom)
for(k in 1:nrow(ref)){
t.ZW <- viz.ZW %>% filter(N == k)
t.TS <- viz.TS %>% filter(N == k)
if(nrow(t.ZW) > 0 | nrow(t.TS) > 0){
t <- ggplot()
if(nrow(t.ZW) > 0) {
t <- t +
geom_tile(data = t.ZW,
aes(r,u, alpha = Per)) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat,
col = as.factor(Societe)))
}
if(nrow(t.TS) > 0){
t <- t +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2)
}
if(nrow(t.TS %>% filter(Entr == 0)) > 0){
t <- t +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng, Slat),
colour = "red",
size = 4)
}
t <- t + facet_wrap(~Nom)
ggsave(filename = paste(ref$Nom[ref$N == k], '.jpg', sep=""),
plot = t)
}
}
for(k in 1:nrow(ref)){
t.ZW <- viz.ZW %>% filter(N == k)
t.TS <- viz.TS %>% filter(N == k)
if(nrow(t.ZW) > 0 | nrow(t.TS) > 0){
t <- ggplot() + xlim(1:8) + ylim(42:45)
if(nrow(t.ZW) > 0) {
t <- t +
geom_tile(data = t.ZW,
aes(r,u, alpha = Per)) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat,
col = as.factor(Societe)))
}
if(nrow(t.TS) > 0){
t <- t +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2)
}
if(nrow(t.TS %>% filter(Entr == 0)) > 0){
t <- t +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng, Slat),
colour = "red",
size = 4)
}
t <- t + facet_wrap(~Nom)
ggsave(filename = paste(ref$Nom[ref$N == k], '.jpg', sep=""),
plot = t)
}
}
for(k in 1:nrow(ref)){
t.ZW <- viz.ZW %>% filter(N == k)
t.TS <- viz.TS %>% filter(N == k)
if(nrow(t.ZW) > 0 | nrow(t.TS) > 0){
t <- ggplot() + xlim(1,8) + ylim(42,45)
if(nrow(t.ZW) > 0) {
t <- t +
geom_tile(data = t.ZW,
aes(r,u, alpha = Per)) +
geom_point(data= gares %>% filter(Societe != 5),
aes(Lng, Lat,
col = as.factor(Societe)))
}
if(nrow(t.TS) > 0){
t <- t +
geom_segment(data = viz.TS %>% filter(N == k),
aes(x=Elng,xend=Slng,
y=Elat,yend=Slat
),
colour = "red",
size = 2)
}
if(nrow(t.TS %>% filter(Entr == 0)) > 0){
t <- t +
geom_point(data = viz.TS %>% filter(Entr == 0, N == k),
aes(Slng, Slat),
colour = "red",
size = 4)
}
t <- t + facet_wrap(~Nom)
ggsave(filename = paste(ref$Nom[ref$N == k], '.jpg', sep=""),
plot = t)
}
}
save.image()
library(ggplot2)
library(dplyr)
result.TS %>% filter(N == 6)
viz.TS %>% filter(N == 6)
trx %>% filter(ID == 980153310002)
input
input %>% filter(Badge == 9801533)
input %>% filter(Badge == 9801533) %>% print(n = 150)
viz.TS %>% filter(N == 45)
viz.TS %>% filter(N == 12)
viz.TS %>% filter(N == 13)
viz.ZW %>% filter(N == 13)
t1 <- trxZoneActiveH %>% group_by(ID,DOW,H) %>% summarise(freq = n())
ggplot(t1 %>% filter(ID %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~ID)
viz.ZW %>% filter(N == 5)
viz.TS %>% filter(N == 5)
trxZoneActiveH
t1 <- trxZoneActiveH %>% group_by(ID,DOW,H) %>% summarise(freq = n())
ggplot(t1 %>% filter(ID %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~ID)
t1
k
viz.TS %>% filter(N ==5)
viz.ZW %>% filter(N ==k)
trxZoneActiveH
viz.Window <- left_join(trxZoneActiveH,ref)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~ID)
viz.Window
viz.Window <- left_join(trxZoneActiveH,ref) %>% group_by(Nom,ID,N,DOW,H) %>% summarise(freq = n())
viz.Window
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~ID)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 13
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 11
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 50
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 15
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 10
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 7
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 1
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
save.image()
k = 24
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
k = 8
viz.TS %>% filter(N ==k)
ggplot(viz.Window %>% filter(N %in% k)) + geom_tile(aes(DOW,H, fill = freq)) + facet_wrap(~Nom)
input %>% filter(EVA == 2423107
)
vis.TS
viz.TS
viz.TS %>% filter(EVA == 2423107)
