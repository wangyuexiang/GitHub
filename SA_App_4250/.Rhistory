ggplot(temp.noGare) +
geom_point(aes(maxPerS,secPerS, col = "Sor")) +
geom_point(aes(maxPerE,secPerE, col = "Entr")) +
geom_segment(aes(x= maxPerE, y = secPerE,
xend=maxPerS, yend = secPerS)) +
scale_y_continuous(limits = c(0,1))
ggplot(temp.noGare) +
geom_point(aes(maxPerS,secPerS, col = "Sor")) +
geom_point(aes(maxPerE,secPerE, col = "Entr")) +
#   geom_segment(aes(x= maxPerE, y = secPerE,
#                    xend=maxPerS, yend = secPerS)) +
scale_y_continuous(limits = c(0,1))
ggplot(temp.noGare) +
geom_point(aes(maxPerS,secPerS, col = "Sor", alpha = .2)) +
geom_point(aes(maxPerE,secPerE, col = "Entr", alpha = .2)) +
#   geom_segment(aes(x= maxPerE, y = secPerE,
#                    xend=maxPerS, yend = secPerS)) +
scale_y_continuous(limits = c(0,1))
ggplot(temp.noGare) +
geom_point(aes(maxPerS, secPerS + maxPerS, col = "Sor", alpha = .2 )) +
geom_point(aes(maxPerE, secPerE + maxPerE, col = "Entr", alpha = .2 ))
ggplot(temp.noGare) +
geom_segment(aes(x= maxPerE, y = secPerE,
xend=secPerE + maxPerE, yend = secPerS + maxPerS, alpha = .1)) +
geom_point(aes(maxPerS, secPerS + maxPerS, col = "Sor", alpha = .2 )) +
geom_point(aes(maxPerE, secPerE + maxPerE, col = "Entr", alpha = .2 ))
ggplot(temp.noGare) +
geom_segment(aes(x= maxPerE, y = secPerE + maxPerE,
xend=maxPerS, yend = secPerS + maxPerS, alpha = .1)) +
geom_point(aes(maxPerS, secPerS + maxPerS, col = "Sor", alpha = .2 )) +
geom_point(aes(maxPerE, secPerE + maxPerE, col = "Entr", alpha = .2 ))
ggplot(temp.noGare) + geom_point(aes(maxPerS,secPerS, size = noGS))
ggplot(temp.noGare) + geom_point(aes(maxPerS, secPerS + maxPerS, size = noGS))
temp.noGare %>% filter(maxPerS > .5)
temp.noGare
temp.noGare %>% filter(maxPerS + secPerS > .5)
ggplot(temp.noGare) + geom_bar(aes(secPerS + maxPerS))
ggplot(temp.noGare) + geom_bar(aes( maxPerS))
ggplot(temp.noGare) + geom_point(aes(maxPerS, secPerS + maxPerS, size = noGS))
ggplot(temp.noGare) + geom_point(aes(maxPerS, secPerS + maxPerS))
temp.noGare %>% filter(maxPerS == secPerS)
t1 <- temp.noGare %>% filter(maxPerS == secPerS)
t1
t1 <- temp.noGare %>% filter(maxPerS == secPerS) %>%
select(ID)
t1
temp
temp.Gare
t1.1 <- left_join(t1, temp.Gare)
t1.1
temp
t1 <- temp.noGare %>% filter(maxPerS == secPerS) %>%
select(ID, maxPerS)
t1.1 <- left_join(t1 %>% rename(perS = maxPerS), temp.Gare)
t1.1
t1
t1 <- temp.noGare %>% filter(maxPerS == secPerS) %>%
select(ID, maxPerS, n)
temp.noGare
result.final
temp.result <- count(result.final, ID)
temp.result
ID.list
temp <- result.final %>%
arrange (ID, desc(noPsg), Tmin) %>%
filter((Tmax - Tmin) <= 1.5)
temp.result <- count(temp, ID)
temp.result <- count(result.final, ID)
temp.result
temp.result <- count(result.final, ID) %>%
transmute(ID, result = (n>1))
temp.result
temp.noGare
temp.ID
t <- full_join(temp.result, temp.noGare)
t
count(t,result)
temp.result <- count(result.final, ID) %>%
transmute(ID, result = (n>=1))
t <- full_join(temp.result, temp.noGare)
count(t,result)
t$result[is.na(t$result)]
t$result <- !is.na(t$result)
t
count(t,result)
ggplot(t) + geom_point(aes(maxPerS, secPerS + maxPerS, col = as.factor(result)))
ggplot(t) + geom_point(aes(maxPerS, secPerS + maxPerS, col = as.factor(result), alpha = .2))
temp.noGare %>% filter(maxPerS > .7)
temp.Gare
ggplot(temp.Gare) + geom_point(aes(ordE,ordS))
ggplot(temp.Gare) + geom_point(aes(noE,noS))
ggplot(temp.Gare) Â°+ geom_bar(aes(maxPerS), binwidth = .2)
ggplot(temp.Gare) + geom_bar(aes(maxPerS), binwidth = .2)
ggplot(temp.noGare) + geom_bar(aes(maxPerS), binwidth = .2)
ggplot(temp.noGare) + geom_bar(aes(maxPerS + secPerS), binwidth = .2)
# analyse no of Entr
temp.noGE <- temp.E %>%
group_by(ID) %>%
arrange(ordE) %>%
summarise(noGE = n(),
maxPerE = max(perE),
secPerE = nth(perE, 2),
thrPerE = nth(perE, 3)
)
temp.noGS <- temp.S %>%
group_by(ID) %>%
arrange(ordS) %>%
summarise(noGS = n(),
maxPerS = max(perS),
secPerS = nth(perS, 2),
thrPerS = nth(perS, 3)
)
sum(is.na(temp.noGE))
sum(is.na(temp.noGE$maxPerE))
sum(is.na(temp.noGE$secPerE))
sum(is.na(temp.noGE$thrPerE))
temp.noGare <- full_join(temp.noGE,temp.noGS)
ggplot(temp.noGare) + geom_bar(aes(maxPerS + secPerS + thrPerS), binwidth = .2)
ggplot(temp.noGare) + geom_density(aes(maxPerS))
ggplot(temp.noGare) + geom_density(aes(maxPerS + secPerS))
ggplot(temp.noGare) + geom_density(aes(maxPerS + secPerS + thrPerS))
ggplot(temp.noGare) +
geom_density(aes(maxPerS, col = "1")) +
geom_density(aes(maxPerS + secPerS, col = "1+2")) +
geom_density(aes(maxPerS + secPerS + thrPerS, col = "1+2+3"))
ggplot(temp.noGare) +
geom_point(aes(maxPerS,secPerS, col = "Sor", alpha = .2)) +
geom_point(aes(maxPerE,secPerE, col = "Entr", alpha = .2)) +
#   geom_segment(aes(x= maxPerE, y = secPerE,
#                    xend=maxPerS, yend = secPerS)) +
scale_y_continuous(limits = c(0,1))
ggplot(temp.noGare) + geom_point(aes(maxPerS,secPerS, size = noGS))
ggplot(temp.noGare) + geom_point(aes(maxPerS, secPerS + maxPerS))
ggplot(temp.noGare) + geom_point(aes(maxPerS, secPerS + maxPerS, size = noGS))
ggplot(temp.noGare) + geom_bar(aes( maxPerS))
ggplot(temp.noGare) + geom_bar(aes(secPerS + maxPerS))
t <- full_join(temp.result, temp.noGare)
t$result <- !is.na(t$result)
ggplot(t) + geom_point(aes(maxPerS, secPerS + maxPerS, col = as.factor(result), alpha = .2))
ggplot(temp.Gare) + geom_point(aes(ordE,ordS))
ggplot(temp.noGare) +
geom_density(aes(maxPerS, col = "1")) +
geom_density(aes(maxPerS + secPerS, col = "1+2")) +
geom_density(aes(maxPerS + secPerS + thrPerS, col = "1+2+3"))
ggplot(temp.noGare) +
geom_density(aes(maxPerS, col = "1")) +
geom_density(aes(maxPerS + secPerS, col = "1+2")) +
geom_density(aes(maxPerS + secPerS + thrPerS, col = "1+2+3")) +
xlab("Per")
ggplot(temp.noGare) + geom_point(aes(maxPerS,secPerS))
ggplot(temp.noGare) + geom_point(aes(maxPerS,maxPerS+ secPerS))
ggplot(t) + geom_point(aes(maxPerS, secPerS + maxPerS, col = as.factor(result), alpha = .2))
t
ggplot(temp.noGare) +
geom_density(aes(maxPerS, col = "1")) +
geom_density(aes(maxPerS + secPerS, col = "1+2")) +
geom_density(aes(maxPerS + secPerS + thrPerS, col = "1+2+3")) +
xlab("Per")
temp.Gare
library(dplyr)
library(ggplot2)
result.final
temp.result <- count(result.final,ID, OD)
temp.result
temp.result <- temp.result %>% rename(WeekPattern = n)
temp.result
temp.result %>% count(ID)
temp.result %>% count(ID, WeekPattern)
temp.result %>% count(ID, WeekPattern) %>% count(n)
temp.result %>% count(ID, WeekPattern) %>% ggplot() + geom_bar(aes(n))
result.final
library(dplyr)
library(cluster)
library(zoo)
result.final
temp.result <- count(result.final,ID, OD)
temp.result
temp.result <- temp.result %>% rename(WeekPattern = n)
count(temp.result,WeekPattern)
temp.result
t <- count(result.final,ID,OD, (Tmax <12))
t
t %>% group_by(ID,OD) %>% summarise(AMPM = n())
t1 <- t %>% group_by(ID,OD) %>% summarise(AMPM = n())
count(t1,AMPM)
t1
t
t <- count(result.final,ID,OD, Tmax <12)
t
count(t,n)
t <- t %>% rename(WeekPattern = n)
t
count(t,WeekPattern)
count(t,WeekPattern)
count(temp.result,Weekend)
count(temp.result,WeekPattern)
sum(temp.result$WeekPattern)
sum(t$WeekPattern)
t
count(t,WeekPattern, Tmax < 12)
t
result.final
temp.result <- result.final
temp.result
temp.result$HP <- NA # heure pointe
temp.result$HP[temp.result$Tmin >= 6 & temp.result$Tmax <- 10] <- "Matin"
temp.result$HP[temp.result$Tmin >= 6 & temp.result$Tmax <= 10] <- "Matin"
temp.result$HP[temp.result$Tmin >= 16 & temp.result$Tmax <= 20] <- "Soir"
count(temp.result, HP)
temp.result$HP[temp.result$Tmin >= 11 & temp.result$Tmax <= 13] <- "Midi"
count(temp.result, HP)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax))
library(ggplot2)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax))
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor((Tmax-Tmin) < 1.5)))
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor((Tmax-Tmin) < 2)))
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))
temp.result$HP[temp.result$Tmin >= 10 & temp.result$Tmax <= 14] <- "Midi"
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+
geom_abline(slope = 1)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+  geom_abline(slope = 1, intercept = 2)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+  geom_abline(slope = 1, intercept = 2, size = 1.5)
count(temp.result,HP)
ggplot(temp.result) + geom_density(aes(Tmax))
ggplot(temp.result) +
geom_density(aes(Tmax, col = "Tmax")) +
geom_density(aes(Tmin, col = "Tmin"))
library(gridExtra)
grid.arrange(g1,g2)
g1 <-ggplot(temp.result) +
geom_density(aes(Tmax, col = "Tmax")) +
geom_density(aes(Tmin, col = "Tmin"))
g2 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+  geom_abline(slope = 1, intercept = 2, size = 1.5)
grid.arrange(g1,g2)
temp.result$HP[temp.result$Tmin >= 20] <- "Night"
g2 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+  geom_abline(slope = 1, intercept = 2, size = 1.5)
grid.arrange(g1,g2)
temp.result$HP[temp.result$Tmin >= 14 & temp.result$Tmax <= 16] <- "Aprem"
g2 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+  geom_abline(slope = 1, intercept = 2, size = 1.5)
grid.arrange(g1,g2)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+
geom_abline(slope = 1, intercept = 2) +
geom_abline(slope = 1, intercept = 4) +
geom_abline(slope = 1, intercept = 6)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax - Tmin, col = as.factor(HP))) + ylab("Time Difference")
g4 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax - Tmin, col = as.factor(HP))) + ylab("Time Difference")
g3 <-ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP))) +
geom_abline(slope = 1, intercept = 2) +
geom_abline(slope = 1, intercept = 4) +
geom_abline(slope = 1, intercept = 6)
grid.arrange(g3,g4)
ggplot(temp.result) +
geom_density(aes(Tmax, col = "Tmax")) +
geom_density(aes(Tmin, col = "Tmin")) +
geom_density(aes(Tmax-Tmin, col = "Tdiff"))
grid.arrange(g1, g3,g4)
library(dplyr)
library(cluster)
library(zoo)
grid.arrange(g1, g3,g4)
library(ggplot2)
library(gridExtra)
grid.arrange(g1, g3,g4)
ggplot(temp.result) + geom_density(aes(Tmax - Tmin)) + xlab("Time Difference")
ggplot(temp.result) + geom_bar(aes(Tmax - Tmin), binwidth = 1) + xlab("Time Difference")
g2
g3
g4
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(DOW), alpha = .2))
temp.result$DOW[temp.result$DOW==0] <- 7
count(temp.result, DOW)
temp.result <- temp.result %>% mutate(WE = (DOW>5))
count(temp.result, WE)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), alpha = .2))
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), alpha = .2)) + facet_wrap(~WE)
ggplot(temp.result) + geom_density(aes(Tmax - Tmin)) + xlab("Time Difference")
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE) size = noPsg, alpha = .2)) + facet_wrap(~WE)
temp.result
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), size = noPsg, alpha = .2)) + facet_wrap(~WE)
grid.arrange(g6, g7, main = weekday vs. weekend)
g6 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), alpha = .2)) + facet_wrap(~WE)
g7 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), size = noPsg, alpha = .2)) + facet_wrap(~WE)
grid.arrange(g6, g7, main = weekday vs. weekend)
grid.arrange(g6, g7, main = "weekday vs. weekend")
grid.arrange(g1, g3,g4)
grid.arrange(g1, g3, main = "Distribution of Tmin & Tmax")
ggplot(temp.result) + geom_bar(aes(Tmax - Tmin), binwidth = 2) + xlab("Time Difference")
g3
count(temp.result, HP)
temp.result$HP[temp.result$Tmin >= 20] <- "Nuit"
count(temp.result, HP)
temp.result$HP[temp.result$Tmin >= 6 & temp.result$Tmax <= 10] <- "10-Matin"
temp.result$HP[temp.result$Tmin >= 10 & temp.result$Tmax <= 14] <- "14-Midi"
temp.result$HP[temp.result$Tmin >= 14 & temp.result$Tmax <= 16] <- "16-Aprem"
temp.result$HP[temp.result$Tmin >= 16 & temp.result$Tmax <= 20] <- "20-Soir"
temp.result$HP[temp.result$Tmin >= 20] <- "20-Nuit"
count(temp.result, HP)
temp.result$HP[temp.result$Tmin >= 20] <- "20+-Nuit"
View(temp.result)
temp.result$HP[temp.result$Tmin >= 20] <- "20+-Nuit"
count(temp.result, HP)
temp.result$HP[temp.result$Tmin >= 20] <- "24-Nuit"
count(temp.result, HP)
temp.result <- time.result %>% mutate(TDiff = Tmax - Tmin)
temp.result <- temp.result %>% mutate(TDiff = Tmax - Tmin)
temp.result$Diff[temp.result$TDiff<= 1] <- "1 SuperRegular"
temp.result$Diff[temp.result$TDiff > 1 & temp.result$TDiff >= 2] <- "2 Regular"
temp.result$Diff[temp.result$TDiff > 2 & temp.result$TDiff >= 4] <- "4 So-So"
temp.result$Diff[temp.result$TDiff > 4] <- "6 Nul"
count(temp.result, Diff)
temp.result %>% filter(is.na(Diff))
temp.result$Diff[temp.result$TDiff > 1 & temp.result$TDiff <= 2] <- "2 Regular"
temp.result$Diff[temp.result$TDiff > 2 & temp.result$TDiff <= 4] <- "4 So-So"
temp.result$Diff[temp.result$TDiff > 4] <- "6 Nul"
count(temp.result, Diff)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+  geom_abline(slope = 1, intercept = 2, size = 1.5)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax))
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff)))
count(temp.result, Diff)
count(temp.result, Diff, HP)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff))) + facet_grid(Diff~HP)
library(ggplot2)
library(gridExtra)
library(dplyr)
library(cluster)
library(zoo)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff)))
count(temp.result, Diff, HP)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff))) + facet_grid(Diff~HP)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff))) + facet_wrap(~DOW)
grid.arrange(g1, g3, main = "Distribution of Tmin & Tmax")
grid.arrange(g6, g7, main = "weekday vs. weekend")
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff))) + facet_grid(Diff~HP)
temp.result
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), alpha = .2)) + facet_wrap(~WE)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff), alpha = .2)) + facet_wrap(~WE)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff))) + facet_grid(Diff~HP)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff))) + facet_grid(Diff~WE)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff))) + facet_grid(Diff~WE)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff), alpha = .2)) + facet_wrap(~WE)
grid.arrange(g1, g3, main = "Distribution of Tmin & Tmax")
g1 + facet_wrap(~WE)
ggplot(temp.result) +
geom_density(aes(Tmax, col = "Tmax")) +
geom_density(aes(Tmin, col = "Tmin")) + facet_wrap(~WE)
temp.result$WE[temp.result$WE == TRUE] <- "Weekend"
temp.result$WE[temp.result$WE == FALSE] <- "Weedday"
count(temp.result,WE)
ggplot(temp.result) +
geom_density(aes(Tmax, col = "Tmax")) +
geom_density(aes(Tmin, col = "Tmin")) + facet_wrap(~WE)
g1 <- ggplot(temp.result) +
geom_density(aes(Tmax, col = "Tmax")) +
geom_density(aes(Tmin, col = "Tmin")) + facet_wrap(~WE)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+
geom_abline(slope = 1, intercept = 2) +
geom_abline(slope = 1, intercept = 4) +
geom_abline(slope = 1, intercept = 6) +
facet_wrap(~WE)
g3 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(HP)))+
geom_abline(slope = 1, intercept = 2) +
geom_abline(slope = 1, intercept = 4) +
geom_abline(slope = 1, intercept = 6) +
facet_wrap(~WE)
grid.arrange(g1, g3, main = "Distribution of Tmin & Tmax")
grid.arrange(g6, g7, main = "weekday vs. weekend")
g6 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), alpha = .2)) + facet_wrap(~WE)
g7 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(WE), size = noPsg, alpha = .2)) + facet_wrap(~WE)
grid.arrange(g6, g7, main = "weekday vs. weekend")
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff)))
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff), alpha = .2)) + facet_wrap(~WE)
ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff), alpha = .2)) + facet_wrap(~WE) + ggtitle("RÃ©gularitÃ© des trajets")
g8 <- ggplot(temp.result) + geom_point(aes(Tmin,Tmax, col = as.factor(Diff), alpha = .2)) + facet_wrap(~WE) + ggtitle("RÃ©gularitÃ© des trajets")
grid.arrange(g8, g7, main = "weekday vs. weekend")
temp.result
library(dplyr)
### add grid
t.lat <- data.frame(
d = seq(42  , 48.9,.5),
u = seq(42.1, 49  ,.5),
Row = seq(1, 14)
)
t.lng <- data.frame(
l = seq(-2  , 7.9, .5),
r = seq(-1.9, 8  , .5),
Col = seq(1,20)
)
t.lat$temp <- 1
t.lng$temp <- 1
t.grid <- inner_join(t.lat, t.lng) %>% tbl_df
t.grid$temp <- NULL
temp <- sens %>% select(Entr, Sor) %>% distinct %>% tbl_df
t1 <- gares %>% transmute(Entr = Cde, Elng = Lng, Elat = Lat)
temp <- left_join(temp, t1)
t1 <- gares %>% transmute(Sor = Cde, Slng = Lng, Slat = Lat)
temp <- left_join(temp, t1)
t1 <- temp %>%
filter(is.na(Elat) & !is.na(Slat)) %>%
mutate(u=Slat + delta.Lat ,
d=Slat - delta.Lat,
r=Slng + delta.Lng,
l=Slng - delta.Lng)
t2 <- temp %>%
filter(!is.na(Elat) & is.na(Slat)) %>%
mutate(u=Elat + delta.Lat,
d=Elat - delta.Lat,
r=Elng + delta.Lng,
l=Elng - delta.Lng)
t3 <- temp %>%
filter(!is.na(Elat) & !is.na(Slat)) %>%
mutate(
u = ( Elat + Slat + abs(Elat - Slat) )/2,
d = ( Elat + Slat - abs(Elat - Slat) )/2,
r = ( Elng + Slng + abs(Elng - Slng) )/2,
l = ( Elng + Slng - abs(Elng - Slng) )/2
)
temp1 <- rbind(t1,t2,t3) %>% rename(U=u, D=d, L=l, R=r)
temp1 <- temp1 %>%
mutate(t = 1) %>%
select(- c(Elng,Elat,Slng,Slat))
t.grid$t <- 1
t.grid
delta.Lat = .1
delta.Lng = .1
t1 <- temp %>%
filter(is.na(Elat) & !is.na(Slat)) %>%
mutate(u=Slat + delta.Lat ,
d=Slat - delta.Lat,
r=Slng + delta.Lng,
l=Slng - delta.Lng)
t2 <- temp %>%
filter(!is.na(Elat) & is.na(Slat)) %>%
mutate(u=Elat + delta.Lat,
d=Elat - delta.Lat,
r=Elng + delta.Lng,
l=Elng - delta.Lng)
t3 <- temp %>%
filter(!is.na(Elat) & !is.na(Slat)) %>%
mutate(
u = ( Elat + Slat + abs(Elat - Slat) )/2,
d = ( Elat + Slat - abs(Elat - Slat) )/2,
r = ( Elng + Slng + abs(Elng - Slng) )/2,
l = ( Elng + Slng - abs(Elng - Slng) )/2
)
temp1 <- rbind(t1,t2,t3) %>% rename(U=u, D=d, L=l, R=r)
temp1 <- temp1 %>%
mutate(t = 1) %>%
select(- c(Elng,Elat,Slng,Slat))
t.grid
t.grid$t <- 1
t.start <- Sys.time()
Grid <- data.frame(Entr = 0, Sor = 0, Row = 0, Col = 0)
for(i in 1:nrow(temp1)){
t1 <- temp1 %>% slice(i)
t2 <- inner_join(t.grid, t1) %>%
filter(u > D,
d < U,
r > L,
l < R) %>%
select(Entr,Sor,Row,Col)
Grid <- rbind(Grid,t2)
}
t.end <- Sys.time()
Grid <- Grid %>% tbl_df %>% slice(-1)
Grid
ggplot(Grid) + geom_tile(aes(Row,Col))
library(knitr)
library(ggplot2)
library(gridExtra)
ggplot(Grid) + geom_tile(aes(Row,Col))
ggplot(Grid) + geom_tile(aes(Row,Col, alpha = 0.1))
ggplot(Grid) + geom_tile(aes(Row,Col, alpha = 0.01))
t1 <- transaction2 %>% filter(ID == 1)
t2 <- inner_join(t1,Grid)
t2
ggplot(t2) + geom_tile(aes(Row, Col),alpha = 0.1)
ggplot(t2) + geom_tile(aes(Col, Row),alpha = 0.1)
save.image()
t2 <- inner_join(transaction2,Grid)
Grid
transaction2
t2 <- inner_join(transaction2,Grid)
count(Grid, Entr, Sor)
t1 <- transaction2 %>% filter(ID == 1)
t2 <- inner_join(t1,Grid)
t2 <- inner_join(transaction2,Grid)
t2
Grid
count(Grid,Entr,Sor)
count(Grid,Entr,Sor) %>% rename(no = n) %>% summarise(nmax = max(n),nmin = min(n))
count(Grid,Entr,Sor) %>% rename(no = n) %>% summarise(nmax = max(no),nmin = min(no))
count(Grid,Entr,Sor) %>% rename(no = n) %>% group_by(Entr,Sor) %>% summarise(nmax = max(no),nmin = min(no))
count(Grid,Entr,Sor) %>% rename(no = n) %>% group_by(Entr,Sor) %>% summarise(nmax = max(no))
count(Grid,Entr,Sor) %>% rename(no = n) %>% ggplot + geom_bar(aes(no))
t2 %>% filter(ID == 1)
count(t2, ID)
t.grid
ggplot(t.grid) + geom_tile(aes(l,d))
ggplot(t.grid) + geom_tile(aes(l,d, col = Row))
ggplot(t.grid) + geom_tile(aes(l,d, filll = Row))
ggplot(t.grid) + geom_tile(aes(l,d, fill = Row))
ggplot(t.grid) + geom_tile(aes(l,d, fill = Col))
ggplot(t.grid) + geom_tile(aes(l,d, fill = Col, col = Row))
ggplot(t2 %>% filter(as.numeric(ID) < 10)) + geom_tile(aes(Col, Row),alpha = 0.1) + facet_wrap(~ID)
t2
t3 <- t2 %>%
filter(TimeSor < 12 ) %>%
group_by(ID, Row, Col) %>%
summarise(noPsg = n(), T = mean(TimeSor), SD = sd(TimeSor), Tmin = T -SD, Tmax = T + SD)
t3
t2
