gares %>% filter(Cde == 25006011)
BDD <- BDD.temp
library(dplyr)
library(ggplot2)
trx
BDD
Ref
ref
print(ref, n = 50)
t <- BDD %>% filter(N== 4)
t
ggplot(t) + geom_point(aes(Date, TimeSor))
temp <- BDD.temp %>% filter(N == 4)
temp.OD <- temp %>%
group_by(Entr, Sor) %>%
summarise(n = n()) %>%
ungroup() %>%
arrange(desc(n)) %>%
mutate(ord = row_number())
temp
t <- temp.OD %>% select(-n)
temp1 <- inner_join(temp,t)
g1 <- ggplot(temp1) + geom_point(aes(Date, TimeSor, col = as.factor(ord))) + theme(legend.position = "none")
g2 <- ggplot(temp1 %>% filter(ord < 3)) + geom_point(aes(Date, TimeSor, col = as.factor(ord)))
temp2 <- temp1 %>% filter(ord <3)
g3 <- ggplot(temp2) + geom_bar(aes(DOW, fill = as.factor(ord)), binwidth = 1, position = "dodge") + theme(legend.position = "none")
g4 <- ggplot(temp2) + geom_bar(aes(TimeSor, fill = as.factor(ord)), binwidth = 1, position = "dodge") + theme(legend.position = "none")
g5 <- ggplot(temp2) + geom_tile(aes(WOY,DOW, fill = as.factor(ord))) + facet_wrap(~ord, ncol = 1) + theme(legend.position = "none")
grid.arrange(g1,g2,g3,g4, g5, ncol = 2, main = title)
library(gridExtra)
grid.arrange(g1,g2,g3,g4, g5, ncol = 2, main = title)
title <- temp$Nom[1]
grid.arrange(g1,g2,g3,g4, g5, ncol = 2, main = title)
temp.OD
temp <- BDD.temp %>% filter(N == 4) %>%
filter(Date > train.start)
temp.OD <- temp %>%
group_by(Entr, Sor) %>%
summarise(n = n()) %>%
ungroup() %>%
arrange(desc(n)) %>%
mutate(ord = row_number())
temp.OD
t <- temp.OD %>% select(-n)
temp1 <- inner_join(temp,t)
# ggplot(temp1) + geom_point(aes(Date, TimeSor))
g1 <- ggplot(temp1) + geom_point(aes(Date, TimeSor, col = as.factor(ord))) + theme(legend.position = "none")
g2 <- ggplot(temp1 %>% filter(ord < 3)) + geom_point(aes(Date, TimeSor, col = as.factor(ord)))
temp2 <- temp1 %>% filter(ord <3)
g3 <- ggplot(temp2) + geom_bar(aes(DOW, fill = as.factor(ord)), binwidth = 1, position = "dodge") + theme(legend.position = "none")
g4 <- ggplot(temp2) + geom_bar(aes(TimeSor, fill = as.factor(ord)), binwidth = 1, position = "dodge") + theme(legend.position = "none")
g5 <- ggplot(temp2) + geom_tile(aes(WOY,DOW, fill = as.factor(ord))) + facet_wrap(~ord, ncol = 1) + theme(legend.position = "none")
grid.arrange(g1,g2,g3,g4, g5, ncol = 2, main = title)
temp.OD
temp
temp %>% filter(Sor == 25006010)
temp %>% filter(Sor == 25006010) %>% count(Voie > 20)
temp %>% filter(Sor == 25006010) %>% count(DOW)
temp.OD
temp.OD
temp %>% filter(Sor == 25004211 & Entr == 25004220)
temp %>% filter(Sor == 25004211 & Entr == 25004220) %>% count(DOW)
temp %>% filter(Sor == 25004211 & Entr == 25004220) %>% summarise(TimeSor)
temp %>% filter(Sor == 25004211 & Entr == 25004220) %>% summary
result
ref %>% filter(N == 4)
Sens
sens
sens %>% filter(Sor == 25004211 & Entr == 25004220)
library(dplyr)
library(cluster)
library(ggplot2)
library(zoo)
library(gridExtra)
temp <- BDD.temp %>% filter(N == 44) %>%
filter(Date > train.start)
temp.OD <- temp %>%
group_by(Entr, Sor) %>%
summarise(n = n()) %>%
ungroup() %>%
arrange(desc(n)) %>%
mutate(ord = row_number())
title <- temp$Nom[1]
t <- temp.OD %>% select(-n)
temp1 <- inner_join(temp,t)
# ggplot(temp1) + geom_point(aes(Date, TimeSor))
g1 <- ggplot(temp1) + geom_point(aes(Date, TimeSor, col = as.factor(ord))) + theme(legend.position = "none")
g2 <- ggplot(temp1 %>% filter(ord < 3)) + geom_point(aes(Date, TimeSor, col = as.factor(ord)))
temp2 <- temp1 %>% filter(ord <3)
g3 <- ggplot(temp2) + geom_bar(aes(DOW, fill = as.factor(ord)), binwidth = 1, position = "dodge") + theme(legend.position = "none")
g4 <- ggplot(temp2) + geom_bar(aes(TimeSor, fill = as.factor(ord)), binwidth = 1, position = "dodge") + theme(legend.position = "none")
g5 <- ggplot(temp2) + geom_tile(aes(WOY,DOW, fill = as.factor(ord))) + facet_wrap(~ord, ncol = 1) + theme(legend.position = "none")
grid.arrange(g1,g2,g3,g4, g5, ncol = 2, main = title)
temp.OD
result
result%>% filter(N == 44)
BDD %>% filter(N == 44)
BDD %>% filter(N == 44) %>% count(Sor)
BDD %>% filter(N == 44) %>% count(Entr)
ref %>% filter(N == 44)
ref %>% filter(N == 4)
BDD
t <- read.table("BDD.fabrice_v20151119.csv", sep = ";", header = TRUE) %>% tbl_df
t
names(t) <- c("cEntr","cSor", "na","badge","DEntr", "DSor", "na2","Ste", "ID" )
t1 <- t %>%
mutate(
ID,
Entr = 25004000 + cEntr,
Sor = 25004000 + cSor,
Y = substr(DSor, 7, 10), M = substr(DSor, 4, 5),Day = substr(DSor, 1, 2),
Date = as.Date(paste0(Y, "-", M, "-", Day)),
DOW = as.POSIXlt(Date)$wday,
WOY = as.numeric(format(Date+3, "%U")),
HH = as.numeric(substr(DEntr, 12, 13)), MM = as.numeric(substr(DEntr, 15, 16)),
TimeEntr = HH + MM / 60,
# HH = as.numeric(substr(DSor, 12, 13)), MM = as.numeric(substr(DSor, 15, 16)),
TimeSor = HH + MM / 60
) %>%
select(ID, Entr, Sor, Date, DOW, WOY, TimeEntr, TimeSor)
t1
t
BDD
t2 <- t %>% mutate(Ste = substr(badge, 1,5),
ID = as.character(substr(badge,6,17)))
t2
t
t1
t1$Voie <- 0
t1
BDD
ref %>% filter(N == 4)
t1 <- t1 %>%
mutate(ID = as.character(903965600001),
Ste = 25004,
EVA = 376235,
Nom = "Fabrice Frajut",
N = 4
)
t1
ggplot(t1) + geom_point(aes(Date, TimeSor))
t1[is.na(t1),]
t1[is.na(t1$TimeSor),]
trx <- t1
trx <- trx %>% mutate(Voie = ifelse(Entr == 0, Voie, 0))
trx <- trx %>% left_join(sens)
trx <- trx %>% mutate(SensEntr = ifelse(is.na(SensEntr), 0, SensEntr),
SensSor = ifelse(is.na(SensSor), 0, SensSor))
trx <- Sens(trx)
trx <- trx %>% mutate(OD = paste0(Entr,"-",Sor,"-",SensEntr,"-",SensSor,"-",Sens))
train.start <- as.Date("2015-9-1")
test.start <- as.Date("2015-10-30")
test.end <- as.Date("2015-11-30")
train.period <- data.frame(Date = seq(train.start, test.start, "day"))
train.period$DOW <- as.POSIXlt(train.period$Date)$wday
test.period <- data.frame(Date = seq(test.start, test.end, "day"))
test.period$DOW <- as.POSIXlt(test.period$Date)$wday
param.days <- GetNumberDays(train.period)
train <- trx %>% filter(Date < test.start)
test <- trx %>% filter(Date >= test.start)
ID.list <- trx %>% group_by(ID) %>% summarise()
### ??? trx or train
models.units <- getModel.units( trx )
# train <- inverse.after.SO(train)
# test <- inverse.after.SO(test)
#Model 0 (decades) : BENCHMARK
result.model.decade.0 <- Model.for.a.decade(train,0,models.units)
# !!! get running time
end.time.model.0 <- Sys.time()
#Model 1 (decades)	Time-Space
result.model.decade.1 <- Model.for.a.decade(train,1,models.units)
#Model 2 (decades) OD -> Space -> Time
result.model.decade.2 <- Model.for.a.decade(train,2,models.units)
test.model.0 <- GetResult(test, result.model.decade.0)
test.model.0$ModelDecade <- 0
ind.model.0 <- GetInd(test.model.0, result.model.decade.0)
ind.model.0$ModelDecade <- 0
### evalutaion model.01
test.model.1 <- GetResult(test, result.model.decade.1)
test.model.1$ModelDecade <- 1
ind.model.1 <- GetInd(test.model.1, result.model.decade.1)
ind.model.1$ModelDecade <- 1
### evalutaion model.02
test.model.2 <- GetResult(test, result.model.decade.2)
test.model.2$ModelDecade <- 2
ind.model.2 <- GetInd(test.model.2, result.model.decade.2)
ind.model.2$ModelDecade <- 2
Ind <- rbind(ind.model.0, ind.model.1, ind.model.2)
Ind <- inner_join ( Ind, models.units)
Ind.final <- Ind %>%
group_by(ID) %>%
summarise( Model = ModelDecade[Ind == max(Ind)][1]*10 + model[Ind == max(Ind)][1])
result <- rbind(result.model.decade.0, result.model.decade.1, result.model.decade.2)
Ind
result.final <- inner_join(result, Ind.final)
result.final
BDD %>% filter(N == 4)
t2 <-  BDD %>% filter(N == 4)
t3 <- rbind(t1,t2)
t3 %>% distinct
max(t2$Date)
ggplot(t2 %>% filter(Date >= as.Date("2015-1-1") )) + geom_bar(aes(WOY))
ggplot(t1 )) + geom_bar(aes(WOY))
ggplot(t1 ) + geom_bar(aes(WOY))
ggplot(t2 %>% filter(Date >= as.Date("2015-1-1") )) + geom_bar(aes(WOY)) + xlim(c(0,45))
ggplot(t1 ) + geom_bar(aes(WOY))+ xlim(c(0,45))
t1
t2
t3 %>%filter(Date > test.end)
t3 %>%filter(Date > train.start)
t3 %>%filter(Date < train.start & Date > as.Date("2015-7-1"))
t2
t15
t1
t2 %>%filter(Date > as.Date("2015-7-1"))
t1 %>%filter(Date > as.Date("2015-7-1"))
t
t1 <- t %>%
mutate(
ID,
Entr = 25004000 + cEntr,
Sor = 25004000 + cSor,
Y = substr(DSor, 7, 10), M = substr(DSor, 4, 5),Day = substr(DSor, 1, 2),
Date = as.Date(paste0(Y, "-", M, "-", Day)),
DOW = as.POSIXlt(Date)$wday,
WOY = as.numeric(format(Date+3, "%U")),
HH = as.numeric(substr(DEntr, 12, 13)), MM = as.numeric(substr(DEntr, 15, 16)),
TimeEntr = HH + MM / 60,
HH = as.numeric(substr(DSor, 12, 13)), MM = as.numeric(substr(DSor, 15, 16)),
TimeSor = HH + MM / 60
) %>%
select(ID, Entr, Sor, Date, DOW, WOY, TimeEntr, TimeSor)
t1$Voie <- 0
t1 <- t1 %>%
mutate(ID = as.character(903965600001),
Ste = 25004,
EVA = 376235,
Nom = "Fabrice Frajut",
N = 4
)
t1
t2 <- BDD %>% filter(N == 4)
t3 <- rbind(t1,t2)
t3 <- rbind(t1,t2) %>% distinct
t1 %>%filter(Date > as.Date("2015-7-1"))
t2 %>%filter(Date > as.Date("2015-7-1"))
trx <- t3
# add SensEntr, SensSor
trx <- trx %>% mutate(Voie = ifelse(Entr == 0, Voie, 0))
trx <- trx %>% left_join(sens)
trx <- trx %>% mutate(SensEntr = ifelse(is.na(SensEntr), 0, SensEntr),
SensSor = ifelse(is.na(SensSor), 0, SensSor))
# combine OD to create trajet
trx <- Sens(trx)
trx <- trx %>% mutate(OD = paste0(Entr,"-",Sor,"-",SensEntr,"-",SensSor,"-",Sens))
# construct train & test set
train <- trx %>% filter(Date < test.start)
test <- trx %>% filter(Date >= test.start)
train
train <- trx %>% filter(Date < test.start)
train <- trx %>% filter(Date < test.start & Date >= train.start)
train.start <- as.Date("2015-7-1")
train <- trx %>% filter(Date < test.start & Date >= train.start)
test <- trx %>% filter(Date >= test.start)
ID.list <- trx %>% group_by(ID) %>% summarise()
# For each person
# NbClusterMax <- getNbClusterMax( train )
### ??? trx or train
models.units <- getModel.units( trx )
# train <- inverse.after.SO(train)
# test <- inverse.after.SO(test)
#Model 0 (decades) : BENCHMARK
result.model.decade.0 <- Model.for.a.decade(train,0,models.units)
# !!! get running time
end.time.model.0 <- Sys.time()
#Model 1 (decades)	Time-Space
result.model.decade.1 <- Model.for.a.decade(train,1,models.units)
#Model 2 (decades) OD -> Space -> Time
result.model.decade.2 <- Model.for.a.decade(train,2,models.units)
##########
test.model.0 <- GetResult(test, result.model.decade.0)
test.model.0$ModelDecade <- 0
ind.model.0 <- GetInd(test.model.0, result.model.decade.0)
ind.model.0$ModelDecade <- 0
### evalutaion model.01
test.model.1 <- GetResult(test, result.model.decade.1)
test.model.1$ModelDecade <- 1
ind.model.1 <- GetInd(test.model.1, result.model.decade.1)
ind.model.1$ModelDecade <- 1
### evalutaion model.02
test.model.2 <- GetResult(test, result.model.decade.2)
test.model.2$ModelDecade <- 2
ind.model.2 <- GetInd(test.model.2, result.model.decade.2)
ind.model.2$ModelDecade <- 2
##########
Ind <- rbind(ind.model.0, ind.model.1, ind.model.2)
Ind <- inner_join ( Ind, models.units)
Ind.final <- Ind %>%
group_by(ID) %>%
summarise( Model = ModelDecade[Ind == max(Ind)][1]*10 + model[Ind == max(Ind)][1])
result <- rbind(result.model.decade.0, result.model.decade.1, result.model.decade.2)
result.final <- inner_join(result, Ind.final)
result.final
BDD <- rbind(BDD, t1)
BDD <- BDD %>% distinct
write.table(BDD, file="BDD.v20151119.csv", sep = ";", row.names = F, quote = F)
library(dplyr)
library(cluster)
library(ggplot2)
library(zoo)
library(gridExtra)
library(knitr)
t <- read.table("BDD.FF.v20151120.csv", sep = ";", header = TRUE) %>% tbl_df
t
t <- read.table("BDD.FF.v20151120.csv", sep = ";", header = TRUE) %>% tbl_df
t <- read.table("BDD_FF_v20151120.csv", sep = ";", header = TRUE) %>% tbl_df
v
t
BDD
BDD %>% filter(N == 44)
BDD %>% filter(N == 4)
BDD %>% filter(N == 4) %>% summary
t2 <- t %>%
mutate(
ID = ID * 1e5 + porteur,
Entr = 25000000 + sEntr * 1000 + cEntr,
Sor = 25000000 + sSor * 1000 + cSor,
Y = substr(DateSor, 1, 4), M = substr(DateSor, 5, 6), D = substr(DateSor, 7, 8),
Date = as.Date(paste0(Y, "-", M, "-", D)),
DOW = as.POSIXlt(Date)$wday,
WOY = as.numeric(format(Date+3, "%U")),
HH = hEntr %/% 10000, MM = ((hEntr %% 10000) %/% 100),
TimeEntr = HH + MM / 60,
HH = hSor %/% 10000, MM = ((hSor %% 10000) %/% 100),
TimeSor = HH + MM / 60
) %>%
select(ID, cEntr, Entr, Sor, Voie, Date, DOW, WOY, TimeEntr, TimeSor)
t2[t2$cEntr == 0, ]$Entr <- 0
t2[t2$cEntr != 0, ]$Voie <- 0
t2$cEntr <- NULL
names(t) <- c("sSor", "cSor", "Voie", "DateSor", "hSor",
"ID", "porteur",
"sEntr", "cEntr", "DateEntr","hEntr",  "voieEntr")
t2 <- t %>%
mutate(
ID = ID * 1e5 + porteur,
Entr = 25000000 + sEntr * 1000 + cEntr,
Sor = 25000000 + sSor * 1000 + cSor,
Y = substr(DateSor, 1, 4), M = substr(DateSor, 5, 6), D = substr(DateSor, 7, 8),
Date = as.Date(paste0(Y, "-", M, "-", D)),
DOW = as.POSIXlt(Date)$wday,
WOY = as.numeric(format(Date+3, "%U")),
HH = hEntr %/% 10000, MM = ((hEntr %% 10000) %/% 100),
TimeEntr = HH + MM / 60,
HH = hSor %/% 10000, MM = ((hSor %% 10000) %/% 100),
TimeSor = HH + MM / 60
) %>%
select(ID, cEntr, Entr, Sor, Voie, Date, DOW, WOY, TimeEntr, TimeSor)
t2[t2$cEntr == 0, ]$Entr <- 0
t2[t2$cEntr != 0, ]$Voie <- 0
t2$cEntr <- NULL
t
t2
ref
temp <- inner_join(t2,ref)
class(temp$ID)
class(t2$ID)
t2 <- t2 %>% mutate(ID = as.character(ID))
temp <- inner_join(t2,ref)
temp
temp_FF <- inner_join(t2,ref)
t <- read.table("BDD_PB_v20151120.csv", sep = ";", header = TRUE) %>% tbl_df
names(t) <- c("sSor", "cSor", "Voie", "DateSor", "hSor",
"ID", "porteur",
"sEntr", "cEntr", "DateEntr","hEntr",  "voieEntr")
t2 <- t %>%
mutate(
ID = ID * 1e5 + porteur,
Entr = 25000000 + sEntr * 1000 + cEntr,
Sor = 25000000 + sSor * 1000 + cSor,
Y = substr(DateSor, 1, 4), M = substr(DateSor, 5, 6), D = substr(DateSor, 7, 8),
Date = as.Date(paste0(Y, "-", M, "-", D)),
DOW = as.POSIXlt(Date)$wday,
WOY = as.numeric(format(Date+3, "%U")),
HH = hEntr %/% 10000, MM = ((hEntr %% 10000) %/% 100),
TimeEntr = HH + MM / 60,
HH = hSor %/% 10000, MM = ((hSor %% 10000) %/% 100),
TimeSor = HH + MM / 60
) %>%
select(ID, cEntr, Entr, Sor, Voie, Date, DOW, WOY, TimeEntr, TimeSor)
t2[t2$cEntr == 0, ]$Entr <- 0
t2[t2$cEntr != 0, ]$Voie <- 0
t2$cEntr <- NULL
t2 <- t2 %>% mutate(ID = as.character(ID))
t2
temp_PB <- inner_join(t2,ref)
temp_FF
temp_PB
BDD <- rbind(BDD, temp_PB,temp_FF)
write.table(BDD, file="BDD.v20151123.csv", sep = ";", row.names = F, quote = F)
BDD %>% filter(N == 44)
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
t <- BDD %>% filter(N == 4 | N == 44)
t
count(t,Nom)
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
test.model.0
### evalutaion model.01
test.model.1 <- GetResult(test, result.model.decade.1)
test.model.1$ModelDecade <- 1
ind.model.1 <- GetInd(test.model.1, result.model.decade.1)
ind.model.1$ModelDecade <- 1
### evalutaion model.02
test.model.2 <- GetResult(test, result.model.decade.2)
test.model.2$ModelDecade <- 2
ind.model.2 <- GetInd(test.model.2, result.model.decade.2)
ind.model.2$ModelDecade <- 2
result.model.decade.0
result.model.decade.1
result.model.decade.2
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
result.model.decade.2
result.model.decade.1
result.model.decade.0
test.model.0 <- GetResult(test, result.model.decade.0)
test.model.0$ModelDecade <- 0
test.model.0
test.model.2 <- GetResult(test, result.model.decade.2)
class(t$ID)
class(test$ID)
class(result.model.decade.0$ID)
class(result.model.decade.0$OD)
class(test$OD)
class(result.model.decade.0$DOW)
class(test$DOW)
test.model.2 <- GetResult(test, result.model.decade.2)
test.model.2$ModelDecade <- 2
test.model.2
result.model.decade.2
test
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
source('~/GitHub/SA_1_click/SA_end2end.R')
result
result.final
trx
BDD
result
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
source('~/GitHub/SA_1_click/SA_end2end.R')
result
result.finql
result.final
result.final %>% count(ID)
ref %>% filter(N == 4)
temp_FF
temp_FF %>% filter(Date > train.start) %>% ggplot + geom_point(aes(Date,TimeSor))
temp_FF %>% filter(Date > train.start) %>% count(Entr,Sor)
temp_FF %>% filter(Date > train.start) %>% count(Entr,Sor) %>% arrange(desc(n))
temp_FF %>% filter(Date > train.start) %>% count(Entr,Sor) %>% ungroup %>% arrange(desc(n))
temp_PB %>% filter(Date > train.start) %>% count(Entr,Sor) %>% ungroup %>% arrange(desc(n))
temp_PB
BDD %>% filter(N == 4) %>% filter(Date > train.start) %>% count(Entr,Sor) %>% ungroup %>% arrange(desc(n))
BDD %>% filter(N == 44) %>% filter(Date > train.start) %>% count(Entr,Sor) %>% ungroup %>% arrange(desc(n))
source('~/GitHub/SA_1_click/SA_end2end.R')
d
test.model.0 <- GetResult(test, result.model.decade.0)
test
source('~/GitHub/SA_1_click/SA_end2end.R')
test
source('~/GitHub/SA_1_click/SA_end2end.R')
test
result.model.decade.0
result.model.decade.1
result.model.decade.2
source('~/GitHub/SA_1_click/SA_end2end.R')
result.final
temp
temp %>% filter(N == 4)
temp %>% filter(N == 44)
save.image()
temp %>% filter(N == 44)
temp %>% filter(N == 4)
temp
temp
temp <- temp %>% arrange(N, desc(noPsg))
temp
count(temp,Nom)
count(temp,N)
BDD %>% filter(N == 1)
BDD %>% filter(N == 4)
temp %>% filter(N == 4)
source('~/GitHub/SA_1_click/SA_function.R', encoding = 'UTF-8')
